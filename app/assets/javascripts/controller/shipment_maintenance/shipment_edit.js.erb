wms.controller('shipmentEditCtrl', function ($scope, $modalInstance, shipment, shipment_detail_id, $http, $location, $q, UserService) {
  var warehouse = $location.search().warehouse;
  var client    = $location.search().client;
  var url = '/shipment_maintenance/'+  shipment + '.json?client=' + client + '&warehouse='+ warehouse;
    $scope.YesorNo = [
    {value: 'Y', text: 'Yes'},
    {value: 'N', text: 'No'},
  ];

    $http.get(url).success(function(data) {
        $scope.shipment_header = data.shipment_header
        $scope.shipment_details = data.shipment_detail
        angular.forEach($scope.shipment_details, function (shipment_detail) {
            console.log(shipment_detail_id)
            if (shipment_detail.id == shipment_detail_id) {
                $scope.shipment_detail = shipment_detail;
            }
        });
    });
  
  $scope.header_template = {
        name: 'header_template',
        url: '<%= asset_path('shipment_maintenance/shipment_header.html') %>'
        }; 

  $scope.detail_template = {
        name: 'detail_template',
        url: '<%= asset_path('shipment_maintenance/shipment_detail.html') %>'
        }; 



  $scope.statuses = [
    {value: 'Created', text: 'Created'},
    {value: 'Initiated', text: 'Initiated'},
    {value: 'In Fullfilment', text: 'In Fullfilment'},
    {value: 'Verified', text: 'Verified'},
    {value: 'Cancelled', text: 'Cancelled'}
  ];


    $scope.updateHeader = function(data, el, id) {

        var warehouse = $location.search().warehouse;
        var shipment  =  $location.search().shipment;
        var client    = $location.search().client;
        var fields_to_update = {};
        var url = '/shipment_maintenance/'+ id + '/update_header' ;
        UserService.updateResource(data, el, id, url, $scope, $q)
    };

    $scope.updateDetail = function(data, el, id) {

        var warehouse = $location.search().warehouse;
        var shipment  =  $location.search().shipment;
        var client    = $location.search().client;
        var fields_to_update = {};
        var url = '/shipment_maintenance/'+ id + '/update_detail';
        UserService.updateResource(data, el, id, url, $scope, $q)
    };
    $scope.ok = function () {
        $modalInstance.close();
    };

    $scope.cancel = function () {
        $modalInstance.dismiss('cancel');
    };

});
